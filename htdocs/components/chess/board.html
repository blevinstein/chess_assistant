<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-ajax/core-xhr.html">

<polymer-element name="chess-board">
  <template>
    <style>
      table {
        border: 5px solid black;
        border-spacing: 0;
      }
      tr {
        height: 80px;
      }
      td {
        text-align: center;
        font-size: 60px;
        width: 80px;
      }
    </style>
    <core-xhr id="xhr"></core-xhr>
    <table>
      <template repeat="{{ rank in ranks }}">
        <tr>
          <template repeat="{{ file in files }}">
            <td style="background-color:{{ getColor(file, rank) }}">
            {{ grid[rank][file].repr }}
            </td>
          </template>
        </tr>
      </template>
    </table>
  </template>
  <script>
    Polymer({
      grid: [ ],

      files: [0, 1, 2, 3, 4, 5, 6, 7],
      ranks: [0, 1, 2, 3, 4, 5, 6, 7],

      getColor: function (file, rank) {
        if ((file + rank) % 2 == 0) {
          return "#bbb";
        } else {
          return "#777";
        }
      },

      setGrid: function (newGrid) {
        this.grid = newGrid;
      },

      ready: function () {
        var self = this;
        this.$.xhr.request({url: "/new-board", callback: function (resp) {
            self.setGrid(JSON.parse(resp));
          }});
      }
    });
  </script>
</polymer-element>
